
<%=  render 'shared/nav_bar_index' %>

<%= form_tag urgent_events_path, method: :get, remote: true, id: "filter-form" do %>

<div class="flexbox-checkbox col-xs-12">
  <div class="flexbox-checkbox-item">
    <div class="col-xs-12">
      <div class = "flexbox-subcheckbox">
        <div>
          <%= check_box_tag :late_rent, nil, params[:late_rent], class: "checkbox-input fancy-checkbox" %>
          <%= label_tag :late_rent%>
        </div>
        <p> Retard de loyer (<%= @late_rent.length %>) </p>
      </div>
    </div>
  </div>

  <div class="flexbox-checkbox-item">
    <div class="col-xs-12">
      <div class = "flexbox-subcheckbox">
        <div>
          <%= check_box_tag :end_of_lease, nil, params[:end_of_lease], class: "checkbox-input fancy-checkbox" %>
          <%= label_tag :end_of_lease%>
        </div>
        <p>Fin de bail (<%= @end_of_lease.length %>) </p>
      </div>
    </div>
  </div>

  <div class="flexbox-checkbox-item">
    <div class="col-xs-12">
      <div class = "flexbox-subcheckbox">
        <div>
          <%= check_box_tag :rent_revision, nil, params[:rent_revision], class: "checkbox-input fancy-checkbox" %>
          <%= label_tag :rent_revision %>
        </div>
        <p>RÃ©vision de loyer (<%= @rent_revision.length %>) </p>
        <% end %>
      </div>
    </div>

  </div>
</div>


<div id="events-container">
  <%= render "events", events: @events %>
</div>

<script>
var turnObjToArray = function(obj) {
  return [].map.call(obj, function(element) {
    return element;
  })
};

var intermediary = document.querySelectorAll('.table-row-event-index');

var linkedRows = turnObjToArray(intermediary)

if (linkedRows.length > 0) {
  linkedRows.forEach((row) => {
    row.addEventListener("click", function() {
    window.location.href=`http://localhost:3000/events/${event.target.parentNode.id}`;
    });
  })
}
</script>
